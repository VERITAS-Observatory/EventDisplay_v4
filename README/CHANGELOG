Change log eventdisplay analysis package
========================================

(please observe the wiki syntax)

* 20140321 (GM)
added HV and Current reading from DB (also plotting); added HV criteria to dead channel finder

* 20140319 (GM)
updated mscw_energy to take new location of calibration trees in eventdisplay files into account (bugzilla Bug 154)

* 20140318 (GM, CB)
introduced simple trace max replacement for sum calculation

* 20140318 (GM)
CTA bug fix in writing of pedestals (average pedestals are used, not the pixel wise values)

* 20140317 (GM)
low-gain integration window settings: fixed settings and width of integration window for double pass window start < 0;
fixed length of integration window for first pass for low gain

* 20140317 (GM)
setting of number of samples (VTS): 
this failed before if first events were incomplete 
(e.g. runs 71717 or 72217)
added consistency checks and require
that nsamples is the same in all telescopes
for VTS. Stop if no consistent result
is achieved after 1000000 events.
(VEventLoop)

* 20140317 (GM) 
plotting: correctly assign dead channel
color for low-gain dead channel (plotted
only if channel is in low gain)

* 20140317 (GM)
significant improvements for dead channel
finder: read now L1 rates from VTS DB and
use them for dead channel identification;
plotting of L1 rates in display; HV and 
currents are in preparation

* 20140317 (GM) 
added automatic adjustment of time slice
length for time dependent pedestal 
calculation (with fixed slice length it
could happen that the last window is only
a few seconds long)

* 20140312 (GM)
CTA trgmask command line changes:
expect now trgmask directory (not file)

* 20140306 (HF, HP)
improved low gain calibration routines
requires updated calibrationlist.LowGain.dat
calculates correctly the integration window
dependent low-gain multiplier

* 20140301 (GM)
CTA DST: added relative gain calibration
(pixel-to-pixel variation in gain was ignored until now)

* 20140225 (GM)
significant (huge) changes in lookup tables filling
use median approximator for efficient and faster filling;
reduces memory requirements by factor of 8-15,
speed up by factor of 2-3;
should not affect any reading of lookup tables

* 20140219 (GM) 
anasum event tree: added 'isgamma' variable

* 20140219 (GM)
bug fix for LL fitting and failed calculation
of error matrix: image angle was calculated
incorrectly; fixed in VArrayAnalyzer::recalculatePhi()

* 20140219 (GM)
NN-time image cleaning: removed dependencies
on fixed image cleaning; update and checked

* 20140218 (GM)
mscw_energy: allow now to copy MC histograms 
for a single spectral index only (useful for CTA)

* 20140213 (GM)
moved and updated the data/MC comparison
functions; improved functionality
now part of the shared library

* 20140211 (GM)
changed range of spectral index for effective area calculations
to 1.5 - 5.4

* 20140211 (GM)
anasum can now read the gamma/hadron
cuts from the effective area files.
Simply remove the gamma/hadron file name
from the anasum input run list.

* 20140211 (GM)
bug fix: dead time was read from wrong
histograms in anasum
(might have introduced a 1-3% systematic
shift in fluxes)

* 20140130 (GM)
changed settings for PSF plotting in sky maps

* 20140124 (GM) 
implemented average tzero calculation
(mean arrival pulse time)
command line parameter:
e.g. -averagetzerofiducialradius=0.75

* 20140124 (GM)
changed low-gain dead channel classification 
(Eventdisplay-WG/931)
low-gain channels are dead now when
their corresponding high-gain is dead

* 20140124 (GM)
dead low-gain channels are now ignored
in LL fit (VImageParameterCalculation)

* 20131222 (GM)
fixed reading of wobble offsets for zero offset pointings

* 20131220 (GM) 
fixed warnings and errors from clang++

* 20131220 (GM)
allow to print list of image and border pixels from display

* 20131220 (GM)
optimized calculation of mean average T0
for CTA DST; use now median average T0 per
telescope type (was: average per telescope)
use also only centre fraction of camera
(new command line parameter 
averagetzerofiducialradius )

* 20131219 (GM)
significant changes in window settings for
charge integration;
summation window of second pass are now always
start at T0+sumwindowShift (was fixed for second
window of second pass);
command line parameter -fixwindow2 is set to 0 by
default (was 1)
adding shift in summation window now to all window
settings (this is set in the parameter file by
-1 FADCSUMMATIONSTART 2 -1
removed parameter fTraceWindowShift_DoublePassSmallImages

*************************************************************
******* 20131219 trunk is now 4.40, to indicate        ******
*******          significant changes                   ******
*************************************************************

* 20131217 (JT, GM) additions to Hough muon analysis
                note that GLS/ROOT mathmore routines are needed
                for this analysis

* 20131216 (MS) next-neigbour cleaning added 
                and new signal extractors
                (preliminary - tests ongoing)

* 20131214 (GM) added plotting of second summation window
                to display

* 20131213 (JG) 3D model: new parameter tree

* 20131201 (GM) removed obsolete command line parameter 
                -tracedefinesmallpulse 

* 20131201 (GM) spectral weighted mean is now used for the 
                energy spectrum plotting (change index with
		VEnergySpectrum::setPlottingSpectralWeightForBinCenter( double iIndex = -2.5 );

* 20131201 (GM) significant additions to PPUT calculation and
                sensitivity file merging (CTA)

* 20131127 (GM) bug fix to prevent chrashes of non-4tel data with
                the bright star option (bugzilla id 145)

* 20131126 (GM) fixed bug in filling nmirrors and mirror area from 
                detector tree (CTA only)

* 20131124 (GM) for BDT gamma/hadron cuts: MVA vs energy curves
                are no by default interpolatd and smoothed

* 20131121 (GM) changed calculation of event rates in sensitivity
                calculation - use CR spectral weighted histograms
                (mainly for CTA)

* 20131121 (GM) added command line option to switch off npe filling
                (CTA only)

*************************************************************
******* 20131120 release of v4.30; trunk is now v4.31 *******
*************************************************************

* 20131118 (GM) updated calibration routines to remove root warnings
                when running tzero calculation

* 20131115 (GM) robust weighted rate calculation for sensitivity
                estimation (CTA)

*************************************************************
******* 20131108 release of v4.30rc; trunk is now v4.30 *****
*************************************************************

* 20131101 (JG, GM) integrated 3D Model
                (note: severe svn hickups; integration by hand)

* 20131030 (GM) added 'npe' to dst trees (CTA)

* 20131030 (GM) first adjustments to read files on the dCache

* 20131028 (GM) added functionality to remove images close to bright
                stars from the stereo reconstruction
                (new keyword in reconstruction runparamer file: BRIGHTSTARS)
                to display bright stars add to the command line
                -starcatalogue Hipparcos_MAG8_1997.dat -starbrightness=7.
                all star related cuts are switched off by default

* 20131023 (GM) added new run parameter to anasum: setting of reflected
                regions (can be random or closest)

* 20131023 (GM) several consistency checks in setting of exclusion
                regions (e.g. due to bright stars in the FOV);
                improved readability of code by removing some signs

* 20130916 (GM) changed CTA converter so that several simtel
                files can be read in in one pass
		(need to increase efficiency for CTA grid analysis)

* 20130912 (GM) switched off random selection of off regions
                for reflected region model.
                default is now: choose closest reflection region
		to source region (due to gradients in sky maps)
		NEEDS FURTHER TESTING

* 20130911 (GM) plotting of stars in display:
                select this option on the command line with
		-starcatalogue 
		(or select any other stars)
		-starbrightness=7
		(plot all stars with B-magnitude brighter than 7)

* 20130910 (GM) bug fix in crate jitter calculation: channel 499 was 
                excluded from calculation and always set to 0. This is
		corrected now (although trace sum for this L2 channel
		is still not corrected; it is needed for debugging only)

* 20130910 (GM) minor version change - 4.28 - reverted changed for 3D model

* 20130906 (GM) minor version change - 4.27 - reverted changed for 3D model

* 20130904 (JG) merging of 3D model with main trunk - tests still pending

* 20130925 (GM) bug fix: background rate per sqr degree calculation in 
                sensitivity section was wrong (CTA only)

* 20130923 (GM) added several CTA requirements values from
                MAN-PO/121004

* 21030918 (GM) improved settings of centroid limits for LL
                fitting procedure (VImageParameterCalculation)
		This improves the fitting of images on the edge of the FOV

* 20130831 (GM) many changes in CTA scripts to allow 
                easy comparision of north/south

* 20130831 (GM) CTA requirements are added to the sensitivity
                plotter (+FOM, etc)

* 20130826 (GM) bug fix in L2 trigger type setting (was always set
                to any trigger condition; CTA only)

* 20130820 (GM) added binary visibility tool (experimental status)
                needs libnova external package

* 20130819 (GM) added Fitstat variable to data tree (mscw_energy)
                This variable gives feedback on the status of the LL fit
		for images on the edge of the FOV

* 20130819 (GM) data/MC comparison: single tel distribution are filled
                from selected events only; improved plotting of comparison
		plots

* 20130812 (GM) minor bug fix in calculation of angular resolution
                (energy reconstruction method was not taken into account)

* 20130812 (GM) changed definition of dE in lookup tables:
                now mean relative uncertainty to median value          

* 20130806 (GM) major changes and improvements for lookup tables
                improved weighted for energy reconstruction
		better efficiency for table filling for CTA
		reduced output file size

* 20130802 (GM) improvements in VExposure plotting (VTS) only

* 20130802 (GM) improvements on the display (mainly birdseye and 'all-in-one' plot)

* 20130802 (GM) corrected any-trigger condition for CTA prod2
                (failed before)

* 20130801 (GM) removed dead time calculation for MC

* 20130801 (GM) added class for plotting of CTA sensitivity requirements
                small improvements in sensitivity plotting

* 20130801 (GM) important bug fix in size2 calculation
                (was not calculated correctly for LL interpolation for
		 events with loss > 0)
		 fixes in LL fit
		 added outlier search for time gradient calculation

* 20130725 (GM) small bug fix to allow calculation of low-gain
                pedestals (VTS only)

* 21030719 (GM) ignore now exclusion regions while filling
                significance distributions from sky maps

* 20130718 (GM) added mpv (most probably value) determination
                in lookup table filling
                (important for low-energy bins with asymmetric 
		 distribution in energy)

* 20130717 (GM) added two new command line parameters to overwrite
                wobble directions read from the VTS DB:
		-overwriteDB_wobblenorth=FLOAT
		-overwriteDB_wobbleeast=FLOAT

* 20130717 (GM) optimized lookup tables filling
                (20% decrease in running time)

* 20130717 (GM) removed obsoled TEL_.. variables from mscw tree

* 20130717 (GM) added new trigger type for CTA prod2:
                require simply a minimum number of pe's
		(default is 30)

* 20130717 (GM) fixed bug in array analysis cuts for trigger types
                (affects CTA prod2 simulations only)

* 20130709 (GM) major cleanup of spectral energy reconstruction
                removed a lot of obsolete code 

* 20130709 (LG) Connection to the DB is now done via the new class VDB_Connection
                (more robust)

* 20130709 (HF) fixed several inconsistencies in UL calculation in Helene method

* 20130709 (GM) cleanup of effective areas code

* 20130709 (GM) added migration matrix interpolation for cosmic rays
                (mainly for CTA sensitivity calculations)

* 20130708 (GM) added input file list to mscw_energy
                (additional option, can be used with wildcards)

* 20130708 (GM) optimization rate and sensitivity calculations (mainly CTA)

* 20130704 (GM) added migration matrix for QC cuts only (CTA)

* 20130703 (GM) fixed bug in relating the correct telescope number to 
                the simtel telescope ID  (CTA/ASTRI)

* 20130703 (GM) added additional checks in reading dead time histograms 
                before adding them to the TList in VDeadTime (Bug 128)

* 20130702 (AMc) some additions to the MC/data comparison
                 (MWR, MLR, etc)

* 20130702 (JT) implementation of the Hough muon analysis
                (integration by GM)

* 20130701 (GM) some optimizations to CTA converter
                (mainly in resetting vectors in VDSTTree)
		x3 improvement in speed

* 20130701 (GM) added reading of trigger mask files to CTA converter
                (allows correction of wrong trigger mask settings in 
		 Spring 2013 prod2 simulations)

* 20130701 (GM) fixed significant bug in tzero_mean settings in CTA converter
                (mix up of telescope ID and telescope number): 
		high impact on small event reconstruction for prod2

* 20130701 (GM) increased maximum number of allowed events for search
                of sample size (elog 694)

* 20130627 (GM) optimize writing of pedestals histograms at the end
                of the pedestal calculation routines (Bug 127)

* 20130612 (GM) added GPS clock status readout

* 20130610 (GM) many small changes to get less warnings while compiling
                (part of the search for a possible memory leak)

* 20130607 (GM) added az dependence to radial acceptance calculation
                improved plotting of radial acceptances

* 20130604 (GM) added scripts to run radial acceptances on a batch system

* 20130604 (GM) significant update: added dead time calculation with scalars
                (dead time is now calculated every 20s, time depencendy is 
		 taken into account in the spectral reconstruction)

* 20130603 (GM) removed hard wired values of maximum allowed distance for acceptance evaulation
                added simple run list reading; improved plotting of radial acceptances

* 20130603 (GM) added scripts to combine effective areas on a batch system
                improved error tolerance to user input of binary

* 20130530 (GM) work on documentation

* 20130524 (GM) Bug fix: close open DB connection in VPM quality control part in
                         case the run failes the quality control

* 20130522 (GM) added tests for completeness while reading line in calibration lines

* 20130522 (GM) Error calculation for effective areas: added Clopper Pearson algorithm
                (normal approximation is still the default)

* 20130521 (GM) improved algorithm to find optimal cuts as function of sensitivity
                requirements and observing time

* 20130415 (GM) major new feature: energy dependent theta2 cut.
                Works and tested for reflected region and ring background model
		Input parameters are a graph of theta2 vs energy, a scale factor to this curve,
		and a min and max theta2 cut value (all given in gamma/hadron cut files)

* 20130425 (GM) change in organisation of IRF/parameter files: gamma/hadron cuts files are now in
                $VERITAS_EVNDISP_AUX_DIR/GammaHadronCutFiles or
		$CTA_EVNDISP_AUX_DIR/GammaHadronCutFiles

* 20130424 (GM) bug fix: calculation of Galactic coordinates in VStarCatalogue was using current epoch
                         ra/dec (should use J2000 values)

*************************************************************
******* 20130424 release of v4.10; trunk is now v4.20 *******
*************************************************************

* 20130424 (GM) adaption to run with root 5.34.06 (changes in VGammaHadronCutsStatistics.h)

* 20130424 (GM) VTS: VPM is now default

* 20130422 (GM) bug fix: stack overflow in CTA converter; needed to redo the calibration tree structure; 
                         (new DST files are not backwards compatible!)

* 20130419 (GM) added additional checks for command line consistency

* 20130416 (GM) fixes so that code compiles with clang++

* 20130415 (GM) added a new script to run anasum with a simple run list

* 20130415 (GM) cleaned up sensitivity calculations at high energies (and low MC statistics)

* 20130408 (GM) bug fix in VTableCalculator (vector out of range); use now median calculation
                from TMath

* 20130403 (GM) bug fix for rare cases when all GPS clocks do not show consistent values
                ensure continuity in MJD from event to event (e.g. see runs 52271-52273)

* 20130402 (GM) bug fix in sky maps for reflected region background model: fixed bug in bin
                assignment which showed up as rings in the maps

* 20130402 (GM) added VPM option to evndisp run scripts (VTS only)

* 20130325 (GM) reduced maximum number of telescope to 100 to fit into available memory 
                resources

* 20130220 (GM) fixed wrong m^2 to cm^2 conversion in plotDailyFluxes in VFluxCalculation

* 20130320 (GM) small bug fix to remove ROOT warnings reading showerpars trees

* 20130319 (GM) added  possibility to switch of DB calibration in VTS.EVNDISP.analyse

* 20130218 (GM) cleanup of pedvars and pedestal calculation. 
                Note: loop now over all telescope types (was: telescopes);
		this shouldn't change anything for VTS

* 20130218 (GM) added handling of pedestal variances in CTA converter

* 20130217 (GM) fixed memory fault in VImageBaseAnalyzer::FADCStopCorrect()

* 20130209 (GM) fixed printing of warnings of dead channels for tzero calculation
                run

* 20130209 (GM) allow VTS data to be in $VERITAS_DATA_DIR/dJJMMDD
                (old default still allowed: $VERITAS_DATA_DIR/data/dJJMMDD)

* 20130202 (GM) stopped writing of unnecessary histograms to outputfile for MC

* 20130202 (GM) added smarter handling of signal-limited regions of
                sensitivity curves (mainly CTA)

* 20130202 (GM) added pedvar calculation for prod2 CTA events

* 20130202 (GM) fixed reading of effective areas for certain CTA WP Phys files

* 20130202 (GM) fixed bug in dead-time calculation, which affects only very
                short runs (few minutes)

* 20130128 (GM) reduced file size of eventdisplay output file (for MC)
                don't write fdiagno tree to disk (anyway empty)
		optimize tpars variables

* 20130123 (GM) fixed memory leak for tzero calculation in VCalibration

* 20130118 (GM) added new error calculation for double pass time gradient fit
                (switch on with -nodb2005)

* 20130118 (GM) introduced clearer cut variable for emission height cut
                allowed names are now: emissionheight and arrayemission

* 20130117 (GM) fixed FOV calculation in converter for CTA simulations

* 20130117 (AMc, GM) correlation cleaning added
                     improve small image reconstruction by searching for 
		     border pixels with correlated traces
                     new keyword CORRELATIONCLEANINGPARAMETER in runparameter file
		     updated camera display to show additional pixels

* 20130117 (GM) cleanup of pointing classes in evndisp
                     introduced new class VArrayPointing to take care of all
		     reference directions
		     clearer variable naming to distinguish between current
		     epoch variables and J2000 values
		     more information saved into pointing trees

* 20130116 (GM) reading of calibration data (gains and toffs) from VOFFLINE DB:
                removed writing of temporary file into calibration directories

* 20130116 (GM) variable renaming for consistent treatment of ra/dec in evndisp and mscw_energy
                added them to showerpars tree

* 20130116 (GM) cleanup of unneeded variables in VArrayAnalyzer; moved some general functions into
                VSkyCoordinatesUtilities

******* version change: trunk is now v4.10 *******

* 20130115 (GM) VTS runparameter tar file target in Makefile: fixed bug in setting directories correctly

* 20130114 (GM) added -readcalibDB to VTS.EVNDISP.analyse_tzeros (toffs need for correct tzero calculation)

* 20130114 (GM) always stop running now when there are NChannel dead channels

* 20130114 (GM) reading evndisp calibration data from DB: make sure that output directory exists

* 20130114 (GM) added missing files to Makefile for target dist

* 20130112 (GM) fixed naming confusion of aux directories: always called CTA_EVNDISP_AUX_DIR or VERITAS_EVNDISP_AUX_DIR 
                                                           (no more VERITAS_EVNDISP_ANA_DIR)

* 20130112 (GM) CTA Prod2: updated for reading of prod2 sims: updated converter, 
                                                              added trigger types to dst tree and showerpars tree; 
							      added sampling rate to telconfig tree; 
							      smaller updates in display to print more information on the screen

* 20130112 (GM) CTA sensitivity files: fixed bug in filling the sensitivity limitation histograms
                                       for off-source data

* 20130112 (GM) VTS next day analysis: fixed access to null pointer in VFluxCalculation
                                       added missing objects to target in Makefile

* 20130111 (GM) CTA scripts: changed usage of CTA.EVNDISP.sub_convert_and_analyse_MC_VDST_ArrayJob.sh
                        (use again runlist instead of a range of runs)

*************************************************************
******* 20130104 release of v4.00; trunk is now v4.01 *******
*************************************************************

Changes from v35x to v400
=========================

Note: the list below tries to summarize the most important changes
      between v35x and v400. It is not complete and it doesn't give
      a weight to the changes according to their significance.

general
    general cleanup and removal of many obsolete functions
    removed a lot of code duplication
    added and clarified comments
    in many places clearer function and variable naming
    simpler structuring of the code
    much simpler usage for general user (hopefully...)

documentation
    added README directory with up-to-date READMEs
    started a tex-based manual (doc directory)

environmental variables
    changed and improved handling of environmental variables
    (can easily change between between CTA and VERITAS settings (or any other observatory))

Changes in evndisplay
=====================

* EVNDISP (VTS) pointing classes
    Use directly pointing directions from database or pointing monitor 
           (v35x: differences of DB values to expected pointing direction were treated as pointing errors)
           This improves slightly the results (many values are functions of ze, az).
           Allow now the consistent analysis of runs taken orbit mode (but: for a complete analysis of orbit mode runs changes in anasum are necessary)
    New setup of pointing classes: VPointing, VSkyCoordinates, VSkyCoordinatesUtilities
    Major cleanup of the pointing code

* EVNDISP (VTS, CTA) pedestals calculation
   fixed bug regarding reading of pedestal events using -teltoana=2 (or anything different then 1) for grisudet sims

* EVNDISP (VTS) zero-suppression cuts
    fixed handling of reading of number of samples per event to allow the analysis of zero-suppressed runs (tested with run 58914)
    write number of zero suppressed channels to output trees; 
    updated display to plot zero suppressed channels correctly
    
* EVNDISP (VTS) QADC mode
   adjusted raw data reader to work with VERITAS QADC mode (e.g. run 62728, 62988)
        
* EVNDISP (VTS): low-gain calibration
    fixed calculation of low-gain pedestals
    added a new calibration file (calibrationlist.LowGain.dat) with validity ranges for low-gain runs
    added small class to combine results from two low-gain flasher runs (VPedestalLowGain)
    added low-gain calibration files (lped) to calibration directory for most recent years
    fixed handling of low-gain multiplier in code (now strictly dependent on summation window)
    added parameter to low-gain calibration file (calibrationlist.LowGain.dat) to give a mean low-gain multiplier per telescope 
    (key word LOWGAINMULTIPLIER, can be given for a certain run range)
    
* EVNDISP (VTS, CTA-FADC Mode): tzero calibration
   added a new TZERO calibration mode (runmode=7) to calculate average tzero for each pixel. 
      This is used for event where no pixels survived the first pass in doublepass
      Added this additional pass to all scripts
      test show significant improvement at low energies in gamma reconstruction
    
* EVNDISP (VTS, CTA-FADC Mode): summation windows
    introduced three summation windows: 
       i) short window for best sensitivity (used as well in second pass of doublepass): returned with getSumWindow() or getSumWindow_1()
       ii) long window to minimize systematics in energy reconstruction (used for size2 calculation): returned with getSumWindow_2()
       iii) summation window for first pass in double pass method: returned with getSumWindow_Pass1()
    Major cleanup in the code. Removed all 'small' variables for double pass second windows
    fixed summation window settings for short readout windows (do not allow to have longer calibration windows then the readout window is)
       
* EVNDISP (VTS, CTA-FADC Mode):  trace handler, charge integration and energy reconstruction
    calculation of integrated charge (sum) per image simultaneously for two summation windows 
        (long: size2 and short: size in tpars tree)   
       The long window is used in the lookup table code for reconstruction of energies. 
    Allow now to add easily new charge integration method (and some have been added)
    Allow telescope-type dependent selection of trace integration parameters
    Added sliding window integration method (not default).
    Added calculation of weighted mean pulse time.
    Cleanup and optimization of trace handler.
    Fixed bug in overflow of saturated low-gain traces for GrISU simulation using external noise files
    Fixed settings of long summation window for pixels on low gain (go back to old style by using command line option -fixwindow2=0)

* EVNDISP (VTS, CTA-FADC Mode): DST
    fixed and improved analysis using DST files
    added FADC traces to DST files (note: large impact on file sizes)

* EVNDISP (VTS, CTA) command line parameters moved to a new parameter file
    trace integration and cleaning parameters are moved to a parameter file 
    (see example file EVNDISP.reconstruction.runparameter)
    
* EVNDISP (VTS, CTA): global run parameters
    moved all VERITAS dependent parameters (e.g. database location, UCLA archive) into external parameter files (EVNDISP.global.runparameter)
        added observatory to this file (height, latitude, longitude)
    
* EVNDISP (VTS, CTA): image cleaning
    several different cleaning methods are available:
    TWOLEVELCLEANING: classical cleaning
    TIMECLUSTERCLEANING and TIMENEXTNEIGHBOUR (both work in progress, expert use only!)
          Allow now different cleaning parameters and method per telescope type.
        All image cleaning parameters are now handled by a class (VImageCleaningRunParameter)

* EVNDISP (VTS, CTA): image parameter calculation
    added minimum number of tube fit for log-likelihood reconstruction
    changed default loss value for  log-likelihood reconstruction from 0 to 10% (LL does not perform very well for small images)
    added lossAndDead image parameter (fraction of size at the edge of FOV + as neighbour of dead pixels) 
    optimized fitting (use now only pixel values from image + surrounding ring; was: whole camera)
    cleanup and simplification of function calls in image parameter calculation
    
* EVNDISP (VTS, CTA): quality cuts for stereo reconstruction
    removed all size cuts, use only one for all cuts. Default values are ntubes>=3, size > 100 and loss < 0.5

* EVNDISP (VTS, CTA): output file: image parameter trees
    added counting of saturated channels; old nsat is now called nlowgain
    added size2 for image size for long integration window
    removed max[0-2] and index_of_max[0-2] from short trees (saves on file size)

* EVNDISP (VTS, CTA): core reconstruction
    fixed problem with parallel images in 2-image events (gave previously NAN for core positions)

* EVNDISP (VTS, CTA):  direction reconstruction
    default method is now the reconstruction of shower and core direction by mean value of intersection value of pairs of intersecting image lines 
    (Hofmann et al 1999, Method 1 (HEGRA method))
    weight depend on image size, elongation of images (width/length), angular separation between image axis
    This method is more robust to ill reconstruction image lines (weighting takes care of this)
    Direction reconstruction is independent of grisu methods.

* EVNDISP (VTS, CTA): modified disp angular reconstruction
    added a modified disp angular reconstruction method (work in progress, expert use only)
    
* EVNDISP (VTS): reading run info from DB
    Added second try for connection with DB server (connection fails sometimes when many jobs are started simultaneously). 
    Wait 10 s for second try.
    
* EVNDISP (VTS, CTA): display
    optimization work to handle more telescopes
    minor fixes to handle events without FADC traces (DSTs)
    fixed annoying color problems in camera plotter
    
FROGS
======

* added FROGS analysis routines
    (does not affect any standard analysis)
  loglikelihood fitting of Template shower images to data and Monte Carlo.

mscw_energy (lookup tables)
=======================

* MSCW_ENERGY (VTS, CTA) lookup table file
    change table handling to reduce file size (new lookup tables are a factor of 7 smaller than old ones)
    all information is now in a single table tree
    remove unfilled bins from lookup tables and reduce histograms  (this is done in the merging of lookup tables in combineLookupTables) 
    default reconstruction ID is now '0' (note that no other reconstruction IDs are needed for the standard analysis)
    significant update on table writer and reader; simplification and performance improvements
    bug fixes: (sum of log values is not the same as log of the sum...)
    fixed inconsistent selection of methods for array variable filling
    use selected images from eventdisplay stage for mean scaled and energy reconstruction (before: used all with decent values)
    added plotter for lookup tables
    added additional checks that evndisplay input files are in healthy state 
        (can be important for MC files, where the MC histograms are the last objects written to the evndisp file)
    
    
effective area and instrument response function calculation
==============================================

*  EFFECTIVE AREA CALCULATION (VTS) merging of effective area files
    fixed several small bugs to handling missing root files
    
*  EFFECTIVE AREA CALCULATION (VTS, CTA), IRFs
    completely rewrote IRF calculation
    added energy resolution a la CTA
    
* EFFECTIVE AREA CALCULATION (VTS, CTA)
    filling MC histograms of thrown events now already at eventdisplay 
    (no necessity to copy trees with MC parameters through the lookup table code, saves orders of magnitudes (!) in disk space)
    major cleanup
    factors of 10-20 performance increase due to different optimization
    added counting of multiple CORSIKA events
    added histogram with unweighted (no spectral weights) events after cuts
    added time dependent effective area code
    improved plotting of effective areas and angular/energy resolution
    added cut on maximum distance of reconstructed shower core to next telescope ("telcoredistance")
    changed order in filling of debug histograms (to keep better track of effect of cuts)
    
* EFFECTIVE AREA CALCULATION (VTS, CTA): spectral weighting
    fixed important cuts important for MC with energy spectra unequal to -2
    optimization
    
gamma-hadron separation
=====================

* CUTS (VTS, CTA): size cut
    SizeSecondMax replaces now all size cuts in the analysis
    (no size cut in stereo reconstruction in eventdisplay)

*  CUTS (VTS, CTA): direction cuts
    cleaned up direction cut section and added parameter to choose the correct one (fDirectionCutSelector)
    implemented energy dependent theta2 cut  (for Monte Carlo only)
    
* CUTS (VTS, CTA):  TMVA based gamma-hadron separation
    added TMVA based gamma-hadron separation (several classes)
    additions to anasum cuts and effective areas to handle this
    added training code and scripts
    (this is 90% tested, still expert use only)

* CUTS (CTA):  telescope type dependent image multiplicity cuts
  allow for example to require at least 2 LSTs, 3 MSTs and 5 SSTs

* CUTS (VTS, CTA):  gamma/hadron statistics
    added class to keep track of different gamma/hadron cuts
    
radial acceptance curve calculation
============================

* RADACCEPTANCE (VTS): I/O
    made code more robust against missing input files
    write cuts to acceptance files (to keep track of them)
    
ANASUM (all VTS)
===============

* ANASUM: energy reconstruction method (lookup tables)
   changed default energy reconstruction method to 1 (tables with lg size on X-axis)
   method 1 shows inconsistencies at low energies (no strict proportionality between size and energy) and event losses at high energies
   Note that the plan is to replace the lookup table based energy reconstruction method by something more sophisticated (NN or BDT)

* ANASUM: spectral energy and flux calculation
    propagated bug fixes from v354 and 355 (first and last bin in spectral energy distribution)
    fixed Rolke upper limit calculation for alpha != 1
    Usage of Li & Ma significance calculation equation 5 in spectral classes.
    The default is now the Rolke method, which should work better as well for the small event numbers we often have.
    Rolke is as well the default for the upper limit calculation
    fixed error calculation to be Poissonian
    Added Rolke based flux calculation (no negative fluxes) (optional)
    added time dependent filling of effective area histograms: allows higher precision for intra-run light curves
    added more functions to spectral fitter (curved and broken power laws)
    
* ANASUM: phase cuts
    allow cuts on phase (e.g. for pulsars or binaries)
    general cleanup
    
* ANASUM: astro classes
    removed (VAstroSource) and replaced by VSkyCoordinates (code was partly duplicated)
    VTargets is made obsolete in most cases, only kept for backwards compatibility
    added VSkyCoordinatesUtilities for most used simple functions
    
* ANASUM: sky map and histogram plotting
    general cleanup
    critical bug fixes related to calculation of distance for current epoch and J2000 coordinates
    (all coordinates away from the sky-map centre were calculated incorrectly)
    fixed long-standing bug in RA axis plotting (was time-zone dependent)
    
sensitivity calculations
==================

* SENS (VTS, CTA): differential and integral sensitivity calculator
    expanded and cross-checked extensively the sensitivity calculation
    implemented sensitivity requirements from CTA
    added errors
    added many debug features and tests

* SENS (VTS, CTA): CTA WP Phys files
    added writer for CTA WP Phys files
    added plotter for CTA WP Phys files
    
tools
====

* (VTS): Crab rate calculator from MC 
    several bug fixes and additions to take new effective area format into account

* (VTS) data base tools
    fixed seg fault in reading of run comments in VRunStats
    
* (VTS): light curve tools
    added new tools to make, plot and analyze light curves (VHE and XRT) -> see Manual
    phase dependent light curves, 
    ZDCF analysis 
    Lomb Scargle analysis
    added different consistency tests for ZDCF and LS
    
* (VTS) balloon data analysis
    fixed macro and script to download and analyse balloon data

scripts
=====

* (VTS, CTA): script for batch cluster
    updated and improved scripts to run a large data set on a batch cluster
    
comparison of data and MC
======================

* (VTS) compareDatawithMC  (former stereoCompare)
   compare MC simulations of gamma rays with excess events from data: removed obsolete code;
   updated pointing classes
   added MVA variables
   improved and added new plotting routines

downloading data from UCLA
=======================
   
* (VTS) VTS.getRunListFromDB
   significantly improved run list generator using the VTS data base
   replaces old perl scripts

    
Class renaming
==============  
    
getEffectiveArea.cpp -> makeEffectiveArea.cpp 
VRunParameterV2 -> VEvndispRunParameter 
cEffArea -> CEffArea 
cEffFit -> CEffFit 
ctRunSummary -> CRunSummary 
cData -> CData 
c_VDST.cpp -> CTA.convert_hessio_to_VDST.cpp 
VAnaUtils  -> VSkyCoordinatesUtilities / VUtilities / VAnalysisUtilities 
(VSkyCoordinatesUtilities for all rotations/timing functions; 
VUtilities all small but useful functions; 
VAnalysisUtilities as before for anasum related functions)
VDataHandler -> VTableLookupDataHandler 
VTableLookRunparameter -> VTableLookupRunparameter 
VParameters -> VImageParameter 
VImageCalculation -> VImageParameterCalculation 
VAnalyzer -> VImageAnalyzer 
VBaseAnalyzer -> VImageBaseAnalyzer / VImageCleaning 
VAnalyzerData -> VImageAnalyzerData 
VAnalyzerHisto -> VImageAnalyzerHistograms 
VData -> VEvndispData 
VAnaCuts -> VGammaHadronCuts 
VPlotBirdsEye -> VDisplayBirdsEye 
makeOptimizeBoxCuts -> makeOptimizeBoxCutsbyParameterSpaceSearch 
mscw -> VTableCalculator 
energy -> VTableEnergyCalculator 
getCrabRate -> VTS.calculateCrabRateFromMC.cpp 
getExposureFromDB -> VTS.calculateExposureFromDB.cpp 
getPhases calculateBinaryPhases -> VEnergy VEffectiveAreaCalculator
moved parts of VSkyCoordinates to VPointing
VStereoCompare->VDataMCComparision
stereocompare -> compareDatawithMC
VEnergyCorrection ->  VEmissionHeightCalculator
    
